 2 t/u/socket_api.h  3+ s/A/W/I/CreateCommandDTO.hs                                                                                                                                                                                         X
  4 {-# LANGUAGE OverloadedStrings #-}                                                                                | 11 {-# LANGUAGE RecordWildCards #-}
  3                                                                                                                   | 10
  2                                                                                                                   |  9
  1                                                                                                                   |  8
5   module API.JSON.Input.Settings                                                                                    |  7 module Go.Settings
  1 ( Settings                                                                                                        |  6 ( Settings (Settings)
  2 , getBoardSize                                                                                                    |  5 , empty
  3 , getIsSuicideAllowed                                                                                             |  4 , getIsSuicideAllowed
  4 ) where                                                                                                           |  3 , getBoardSize
  5                                                                                                                   |  2 ) where
  6                                                                                                                   |  1
  7                                                                                                                   |12
  8 import           Data.Aeson  (FromJSON, Value (Object), parseJSON, (.:?))                                         |  1
  9 import           Go.Settings (Settings (Settings), getBoardSize,                                                  |  2 import           Data.Maybe (fromMaybe)
 10                               getIsSuicideAllowed)                                                                |  3
 11                                                                                                                   |  4
 12                                                                                                                   |  5
 13                                                                                                                   |  6 data Settings = Settings { boardSize        :: Maybe Int
 14 instance FromJSON Settings where                                                                                  |  7                          , isSuicideAllowed :: Maybe Bool
 15   parseJSON (Object v) = Settings                                                                                 |  8                          } deriving (Show)
 16     <$> v .:? "boardSize"                                                                                         |  9
 17     <*> v .:? "isSuicideAllowed"                                                                                  | 10
 18                                                                                                                   | 11
~                                                                                                                     | 12 empty :: Settings
~                                                                                                                     | 13 empty = Settings { boardSize        = Nothing
~                                                                                                                     | 14                  , isSuicideAllowed = Nothing
~                                                                                                                     |src/Go/Settings.hs                                                                                  12,0-1         Top
~                                                                                                                     |   15 {-# LANGUAGE OverloadedStrings #-}
~                                                                                                                     |   14 {-# LANGUAGE RecordWildCards   #-}
~                                                                                                                     |   13
~                                                                                                                     |   12
~                                                                                                                     |   11
~                                                                                                                     |   10 module API.WebSocket.Input.CreateCommandDTO
~                                                                                                                     |    9 ( CreateCommandDTO (CreateCommandDTO)
~                                                                                                                     |    8 , getSettings
~                                                                                                                     |    7 ) where
~                                                                                                                     |    6
~                                                                                                                     |    5
~                                                                                                                     |    4
~                                                                                                                     |    3 import           API.JSON.Input.Settings        (Settings)
~                                                                                                                     |    2 import           API.WebSocket.Input.CommandDTO (CommandDTO (Create))
~                                                                                                                     |    1 import           Control.Applicative            (empty)
~                                                                                                                     |  16  import           Data.Aeson                     (FromJSON, Value (Object),
~                                                                                                                     |    1                                                  parseJSON, (.:))
~                                                                                                                     |    2
~                                                                                                                     |    3
~                                                                                                                     |    4
~                                                                                                                     |    5 data CreateCommandDTO = CreateCommandDTO { name     :: CommandDTO
~                                                                                                                     |    6                                          , settings :: Settings
~                                                                                                                     |    7                                          } deriving (Show)
~                                                                                                                     |    8
~                                                                                                                     |    9
~                                                                                                                     |   10
src/API/JSON/Input/Settings.hs [+]                                                                  5,1            All src/API/WebSocket/Input/CreateCommandDTO.hs                                                         16,1           Top
"src/API/WebSocket/Input/CreateCommandDTO.hs" 40L, 966B written
